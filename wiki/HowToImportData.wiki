<wiki:toc max_depth="2" />

= Transfer from dev to prod =

{{{
scp oa_os@geolin01.cti.ac.at:/srv/www/htdocs/oa_os/openaddresses/trunk/openaddresses/data/carolina/*.zip .

scp oa_os@geolin01.cti.ac.at:/srv/www/htdocs/oa_os/openaddresses/trunk/openaddresses/data/zipcode/* .

scp oa_os@geolin01.cti.ac.at:/srv/www/htdocs/oa_os/openaddresses/trunk/openaddresses/data/country/* .

scp oa_os@geolin01.cti.ac.at:/srv/www/htdocs/oa_os/openaddresses/trunk/openaddresses/data/washington/* .
}}}
= Situs Addresses for State of Arkansas =

 * Data origin: Arkansas Geographic Information Office- Putting Arkansas on the Map!
 * Contact person: Learon Dalby- GIS Program Manager / learon.dalby at arkansas.gov
 * License validation: email from 4/30/2010
 * Import shapefile

{{{
unzip *.zip

shp2pgsql -s 4326 STRUC_SITUS_ADDRESS_PT_point arkansas > arkansas.sql

psql -d openaddresses -f arkansas.sql

sudo su postgres 

psql -d openaddresses

INSERT INTO address (
   housenumber,
   street,
   postcode,
   city,
   country,
   region,
   created_by,
   time_created,
   reference,
   quality,
   geom) (SELECT
      adr_num,
      rtrim(ltrim(pstr_name || ' ') || coalesce(pstr_type,'')),
      adr_zip5,
      adr_city,
      'US',
      cnty_name,
      'arkansas.gov',
      now(),
      'http://www.openaddresses.org',
      'Donated',
      ST_Force_2D(ST_SetSRID(the_geom,4326))
   FROM arkansas);
}}}

= North Carolina =

 * Data origin: NC Center for Geographic Information & Analysis
 * Contact person: juliaharrell at mindspring.com 
 * License validation: email from 4/30/2010
 * Import shapefile

{{{
unzip NCMasterAddress_area01_shp.zip
unzip NCMasterAddress_area02_shp.zip
unzip NCMasterAddress_area03_shp.zip
unzip NCMasterAddress_area04_shp.zip
unzip NCMasterAddress_area05_shp.zip
unzip NCMasterAddress_area06_shp.zip
unzip NCMasterAddress_area07_shp.zip
unzip NCMasterAddress_area08_shp.zip
unzip NCMasterAddress_area09_shp.zip
unzip NCMasterAddress_area10_shp.zip

shp2pgsql -s 4326  NCMasterAddress_Area01 carolina1 > carolina1.sql
shp2pgsql -s 4326  NCMasterAddress_Area02 carolina2 > carolina2.sql
shp2pgsql -s 4326  NCMasterAddress_Area03 carolina3 > carolina3.sql
shp2pgsql -s 4326  NCMasterAddress_Area04 carolina4 > carolina4.sql
shp2pgsql -s 4326  NCMasterAddress_Area05 carolina5 > carolina5.sql
shp2pgsql -s 4326  NCMasterAddress_Area06 carolina6 > carolina6.sql
shp2pgsql -s 4326  NCMasterAddress_Area07 carolina7 > carolina7.sql
shp2pgsql -s 4326  NCMasterAddress_Area08 carolina8 > carolina8.sql
shp2pgsql -s 4326  NCMasterAddress_Area09 carolina9 > carolina9.sql
shp2pgsql -s 4326  NCMasterAddress_Area10 carolina10 > carolina10.sql

sudo su postgres

psql -d openaddresses -f carolina1.sql
psql -d openaddresses -f carolina2.sql
psql -d openaddresses -f carolina3.sql
psql -d openaddresses -f carolina4.sql
psql -d openaddresses -f carolina5.sql
psql -d openaddresses -f carolina6.sql
psql -d openaddresses -f carolina7.sql
psql -d openaddresses -f carolina8.sql
psql -d openaddresses -f carolina9.sql
psql -d openaddresses -f carolina10.sql


sudo su postgres
psql -d openadresses

INSERT INTO address (
   housenumber,
   street,
   postcode,
   country,
   region,
   created_by,
   time_created,
   reference,
   quality,
   geom) (SELECT
      address_nu,
      rtrim(ltrim(str_name || ' ') || coalesce(str_po_typ,'')),
      zip_code,
      'US',
      county,
      'The State of NC',
      now(),
      'http://www.openaddresses.org',
      'Donated',
      GeomFromEWKT('SRID=4326;POINT(' || address_lo || ' ' || address_la || ')') geom
   FROM carolinax);
}}}

 * Set zipcode

{{{
update public.address set city = (select public.zipcode.city from public.zipcode where public.address.postcode = public.zipcode.zip and public.zipcode.zip is not null) where public.address.created_by = 'The State of NC'; 
}}}

= US ZIP Code =

 * Data origin: http://mappinghacks.com/data/ http://ramsonit.wordpress.com/2008/04/29/free-us-zip-code-database-as-csv/
 * Contact person: schuyler geocoder.us
 * License: The database andthis README are copyright 2004 CivicSpace Labs, Inc., and are published under a Creative Commons Attribution-ShareAlike license, which requires that all updates must be released under the same license. See http://creativecommons.org/licenses/by-sa/2.0/ for more details.

{{{
sudo su postgres

create table zipcode (
    zip char(5) primary key,
    city varchar(64),
    state char(2),
    latitude varchar(64),
    longitude varchar(64),
    timezone int,
    dst varchar(16)
);

COPY zipcode FROM '/home/admin/openaddresses/trunk/openaddresses/data/zipcode/zipcode.csv' WITH DELIMITER ',' CSV HEADER NULL AS '';

create index zipcode_zip on zipcode USING btree(zip);
}}}

= World countries =

 * Data origin: http://www.gadm.org/
 * Contact person: ?
 * License validation: This dataset is freely available for academic and other non-commercial use. Redistribution, or commercial use, is not allowed without prior permission.
 * Import shapefile

{{{
shp2pgsql -s 4326  gadm1_lev0 country > country.sql

sudo su postgres

psql -d openaddresses -f country.sql

psql -d openaddresses

CREATE INDEX idx_country_geom
  ON country
  USING gist
  (the_geom);
}}}

= Washington,DC =

 * Data origin: GIS department for Washington, DC
 * Contact person: davidy.jackson at dc.gov
 * License validation: email from 4/08/2010
 * Import shapefile

{{{

unzip AddressPt.ZIP

shp2pgsql -s 26985 AddressPt washington > washington.sql

sudo su postgres

psql -d openaddresses -f washington.sql

psql -d openaddresses

INSERT INTO address (
   housenumber,
   street,
   postcode,
   city,
   country,
   region,
   created_by,
   time_created,
   reference,
   quality,
   geom) (SELECT
     substring(addrnum || ' ' || coalesce(addrnumsuf,'') from 1 for 8),
     rtrim(ltrim(coalesce(stname,'')) || ' ' || coalesce(street_typ,'') ||  ' ' || coalesce(quadrant,'')),
     round(zipcode),
     'Washington',
     'US',
     'DC',
     'DC GIS',
     now(),
     'http://www.openaddresses.org',
     'Donated',
     GeomFromEWKT('SRID=4326;POINT(' || longitude|| ' ' || latitude || ')') geom
FROM washington where status != 'RETIRE');

}}}